<div class="navbar navbar-default navbar-fixed-top" ng-if="!navbarCtrl.state.current.data.hideNavbar">
    <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-header-collapse"
            ng-click="mobileNavClosed = !mobileNavClosed" ng-init="mobileNavClosed = true">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" style="margin-top: -10px" href="#" ui-sref="dashboard">
            <img ng-src="assets/images/searchlight_full.png" alt="Searchlight" />
        </a>
    </div>

    <div ng-class="{'collapse': mobileNavClosed, 'navbar-collapse': mobileNavClosed, 'navbar-header-collapse': mobileNavClosed}"
        ng-if="authenticated">
        <ul class="nav navbar-nav" ng-mouseleave="stationsOpen = false; formsOpen = false">

            <!-- START: BORDERSTATIONS -->
            <li class="dropdown" ng-class="{open:stationsOpen}"
                ng-show="navbarCtrl.session.checkPermission('PROJECTS','VIEW',null, null);"
                ng-mouseleave="stationsOpen = false">
                <a class="dropdown-toggle" data-toggle="dropdown" id="border_station_dropdown"
                    ng-click="stationsOpen=!stationsOpen">Projects
                    <b class="caret"></b>
                </a>
                <ul id="border-station-dropdown" class="dropdown-menu">
                    <li>
                        <a ui-sref="border-station({id: null})"
                            ng-show="navbarCtrl.session.checkPermission('PROJECTS','ADD',null, null);">
                            Create Project
                        </a>
                    </li>
                    <hr style="margin: 4px" />
                    <li class="country-menu" ng-repeat="country in navbarCtrl.countryNames">
                        <div class="country-label" ng-click="isCollapsed = !isCollapsed">
                            <h4>{{country}}</h4>
                            <i ng-class="{'glyphicon-menu-right': isCollapsed, 'glyphicon-menu-down': !isCollapsed }"
                                class="glyphicon icon"></i>
                        </div>
                        <div ng-repeat="category in navbarCtrl.categoryNames">
	                        <div class="project-category" ng-if="navbarCtrl.countryCategoryMap[country + ':' + category]"
	                        		ng-click="navbarCtrl.collapse[country + ':' + category] = !navbarCtrl.collapse[country + ':' + category]">
	                        	<p uib-collapse="isCollapsed">
	                                <i>{{ category }}</i>
	                                <i ng-class="{'glyphicon-menu-right': navbarCtrl.collapse[country + ':' + category], 'glyphicon-menu-down': !navbarCtrl.collapse[country + ':' + category] }"
                                		class="glyphicon icon"></i>
	                        	</p>
	                        </div>
	                        <div class="border-station">
	                            <p ng-repeat="station in navbarCtrl.countryCategoryMap[country + ':' + category]" ng-if="station.open"
	                                uib-collapse="isCollapsed || navbarCtrl.collapse[country + ':' + category]">
	                                <a ui-sref="border-station({id: station.id, countryId: station.operating_country})"
                                        ng-click="trackButtonClick('Project Link: '+station.station_name)">
	                                    {{ station.station_name }}
	                                </a>
	                            </p>
	                        </div>
	                	</div>
                    </li>
                </ul>
            </li>
            <!-- END: BORDERSTATIONS -->

            <!-- START: FORMS -->
            <li class="dropdown" ng-class="{open:formsOpen}"
                ng-hide="!navbarCtrl.session.user.permission_irf_view && !navbarCtrl.session.user.permission_vif_view"
                ng-mouseleave="formsOpen = false">
                <a class="dropdown-toggle" data-toggle="dropdown" ng-click="formsOpen=!formsOpen">Forms
                    <span class="caret"></span>
                </a>
                <ul class="dropdown-menu">
                    <li>
                        <a ng-show="navbarCtrl.session.checkPermission('IRF','VIEW',null, null)"
                            ui-sref="irfNewList"
                            ng-click="trackButtonClick('IRFs')">IRFs</a>
                    </li>
                    <li>
                        <a ng-show="navbarCtrl.session.checkPermission('CIF','VIEW',null, null)"
                            ui-sref="cifList"
                            ng-click="trackButtonClick('CIFs')">CIFs</a>
                    </li>
                    <li>
                        <a ng-show="navbarCtrl.session.checkPermission('VDF','VIEW',null, null)"
                            ui-sref="vdfList"
                            ng-click="trackButtonClick('VDFs')">VDFs</a>
                    </li>
                    <li>
                        <a ng-show="navbarCtrl.session.checkPermission('PVF','VIEW',null, null)"
                            ui-sref="pvfList"
                            ng-click="trackButtonClick('PVFs')">PVFs</a>
                    </li>
                    <li>
                        <a ng-show="navbarCtrl.session.checkPermission('SF','VIEW',null, null)"
                            ui-sref="sfList"
                            ng-click="trackButtonClick('SFs')">SFs</a>
                    </li>
                    <li>
                        <a ng-show="navbarCtrl.session.checkPermission('LF','VIEW',null, null)"
                            ui-sref="lfList"
                            ng-click="trackButtonClick('LFs')">LFs</a>
                    </li>
                    <li>
                        <a ng-show="navbarCtrl.session.checkPermission('MONTHLY_REPORT','VIEW',null, null)"
                            ui-sref="monthlyReportList"
                            ng-click="trackButtonClick('SMRs')">SMRs</a>
                    </li>
                    <li>
                        <a ng-show="navbarCtrl.session.checkPermission('BUDGETS','VIEW',null, null);"
                            ui-sref="budgetList"
                            ng-click="trackButtonClick('MDFs')">MDFs</a>
                    </li>
                    <li>
                        <a ng-show="navbarCtrl.session.checkPermission('EMP','VIEW',null, null);"
                            ui-sref="empList"
                            ng-click="trackButtonClick('Emps')">Emps</a>
                    </li>
                    <li>
                        <a ng-show="navbarCtrl.session.checkPermission('GSP','VIEW',null, null);"
                            ui-sref="gspList"
                            ng-click="trackButtonClick('Gsps')">Gsps</a>
                    </li>
                </ul>
            </li>
            <!-- END: FORMS -->
            <!-- START: REPORTS -->
            <li class="dropdown" ng-class="{open:reportsOpen}"
            	ng-hide="!(navbarCtrl.session.checkPermission('CIF','VIEW',null, null)||navbarCtrl.session.checkPermission('IRF','VIEW',null, null)||navbarCtrl.session.checkPermission('VDF','VIEW',null, null)||navbarCtrl.session.checkPermission('MONTHLY_REPORT','VIEW',null, null))"
                ng-mouseleave="reportsOpen = false">
                <a class="dropdown-toggle" data-toggle="dropdown" ng-click="reportsOpen=!reportsOpen">Data Summaries
                    <span class="caret"></span>
                </a>
                <ul class="dropdown-menu">
                	<li>
                        <a ng-show="navbarCtrl.session.checkPermission('CIF','VIEW',null, null)||navbarCtrl.session.checkPermission('IRF','VIEW',null, null)||navbarCtrl.session.checkPermission('VDF','VIEW',null, null)"
                        	ui-sref="collectionIndicators"
                            ng-click="trackButtonClick('Collection Indicators')">Data Collection Indicators</a>
                    </li>
                    <li>
                        <a ng-show="navbarCtrl.session.checkPermission('CIF','VIEW',null, null)||navbarCtrl.session.checkPermission('IRF','VIEW',null, null)||navbarCtrl.session.checkPermission('VDF','VIEW',null, null)"
                        	ui-sref="indicators"
                            ng-click="trackButtonClick('Entry Indicators')">Data Entry Indicators</a>
                    </li>
                    <li>
                    	<a ng-show="navbarCtrl.session.checkPermission('MONTHLY_REPORT','VIEW',null, null)"
                    		ui-sref="monthlyReportSummary"
                            ng-click="trackButtonClick('SMR Summary')">SMR Summary</a>
                    </li>
                </ul>
            </li>
             <!-- END: REPORTS -->
             
	         <li class="dropdown" ng-class="{open:stationStatsOpen}"
            	ng-show="navbarCtrl.session.checkPermission('PROJECT_STATISTICS','VIEW',null, null)"
                ng-mouseleave="stationStatsOpen = false">
                <a class="dropdown-toggle" data-toggle="dropdown" ng-click="stationStatsOpen=!stationStatsOpen">Project Stats
                    <span class="caret"></span>
                </a>
                <ul class="dropdown-menu">
                	<li>
                        <a ng-show="navbarCtrl.session.checkPermission('PROJECT_STATISTICS','VIEW',null, null)"
                        	ui-sref="operationsDashboard"
                            ng-click="trackButtonClick('Projects Dashboard')">Dashboard</a>
                    </li>
                    <li>
                        <a ng-show="navbarCtrl.session.checkPermission('PROJECT_STATISTICS','VIEW',null, null)"
                        	ui-sref="stationData"
                            ng-click="trackButtonClick('Project Data')">Project Data</a>
                    </li>
                    <li>
                        <a ng-show="navbarCtrl.session.checkPermission('PROJECT_STATISTICS','VIEW',null, null)"
                        	ui-sref="locationData"
                            ng-click="trackButtonClick('Location Data')">Location Data</a>
                    </li>
                    <li>
                        <a ng-show="navbarCtrl.session.checkPermission('PROJECT_STATISTICS','VIEW',null, null)"
                        	ui-sref="locationStaff"
                            ng-click="trackButtonClick('Location Staffing')">Location Staffing</a>
                    </li>
                </ul>
            </li>
            <li>
                <a ng-show="navbarCtrl.session.checkPermission('LEGAL_CASE','VIEW',null, null);"
                    ui-sref="legalCaseList"
                    ng-click="trackButtonClick('Legal Cases')">Legal Cases</a>
            </li>
            <li>
            	<a ng-show="navbarCtrl.session.checkPermission('AUDIT','VIEW',null, null)"
                    ui-sref="auditList"
                    ng-click="trackButtonClick('Audits')">Audits</a>
            </li>
            <li class="dropdown" ng-class="{open:followUpsOpen}"
                ng-hide="!navbarCtrl.session.checkPermission('GOSPEL_VERIFICATION','VIEW',null, null)"
                ng-mouseleave="followUpsOpen = false">
                <a class="dropdown-toggle" data-toggle="dropdown" ng-click="followUpsOpen=!followUpsOpen">Follow-ups
                    <span class="caret"></span>
                </a>
                <ul class="dropdown-menu">
                    <li>
                        <a ng-show="navbarCtrl.session.checkPermission('GOSPEL_VERIFICATION','VIEW',null, null)"
                            ui-sref="gospelVerificationList"
                            ng-click="trackButtonClick('Gospel Verification')">Gospel Verification</a>
                    </li>
                </ul>
            </li>
        </ul>
        

        <ul class="nav navbar-nav navbar-right">
            <!-- START: USER SETTINGS -->
            <li class="dropdown" ng-class="{open:menuOpen}" ng-mouseleave="menuOpen = false">
                <a class="dropdown-toggle" data-toggle="dropdown" ng-click="menuOpen=!menuOpen">
                <img ng-src="assets/images/menu-alt.png" hspace="20">
                </a>
                <ul class="dropdown-menu">
                    <li>
                        <a href="#" ng-show="navbarCtrl.session.user.permission_accounts_manage"
                            ui-sref="accounts.list"
                            ng-click="trackButtonClick('Accounts & Permissions')">Accounts & Permissions</a>
                    </li>
                    <li>
                        <a ui-sref="countries"
                            ng-click="trackButtonClick('Countries')">Countries</a>
                    </li>
                    <li>
                        <a ui-sref="personManagementList"
                            ng-show="navbarCtrl.session.checkPermission('PERSON_MANAGEMENT','EDIT',null, null)"
                            ng-click="trackButtonClick('Person Management')">Person Management</a>
                    </li>
                    <li>
                        <a ui-sref="traffickermatch"
                           ng-show="navbarCtrl.session.user.permission_person_match"
                            ng-click="trackButtonClick('Person Match')">Person Match</a>
                    </li>
                    <li>
                        <a ui-sref="helpvideo"
                            ng-click="trackButtonClick('Help Videos')">Help Videos</a>
                    </li>
                    <li class="divider"></li>
                    <li ng-click="navbarCtrl.logout()">
                        <a href="#"
                            ng-click="trackButtonClick('Logout')">Logout</a>
                    </li>
                </ul>
            </li>
            <!-- END: USER SETTINGS -->
        </ul>
    </div>
</div>